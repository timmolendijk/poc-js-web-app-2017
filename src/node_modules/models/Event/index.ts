import * as moment from 'moment';
import { pick } from 'lodash';
import { computed } from 'mobx';
import { getFields, field, identifier, observable } from 'state';
import Transport from './transport';

export default class Event {

  // TODO(tim): Turns out, if class contains a getter or method named `name`,
  // `Event.name` no longer returns `"Event"` (but instead `""`). Why??
  static readonly displayName = 'Event';

  static readonly Transport = Transport;

  // TODO(tim): Is this data as in identical to store contents? Or values as in
  // identical to what the object fields return upon get?
  constructor(data?) {
    Object.assign(this, pick(data, getFields(this)));
  }

  @observable(identifier(field))() id: string | number;
  @observable(field)() name: string;
  @observable(field)() pageUrl: string;
  @observable(field)() venueName: string;
  @observable(field)() startTime: number;

  @computed get startMoment(): moment.Moment {
    return moment(this.startTime);
  }

}
